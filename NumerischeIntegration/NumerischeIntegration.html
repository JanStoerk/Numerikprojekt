<!doctype html>
<html>

<head>
    <link rel="stylesheet" href="../LandingPage/style.css">
    <title>Numerische Integration</title>
    <meta charset="utf-8" />
    <script src="./geogebra.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.4.4/math.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        table td {
            vertical-align: middle;
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="brand">
            <a href="../LandingPage/index.html" style="color:white;" class="link">
                <img src="../pictures/infinite.png" style="width:50px; height:30px; align-self: center;" alt="Numerik">
                <h1>Numerik</h1>
            </a>
        </div>
        <button class="guide" onclick="showGuide()">
            <img src="../pictures/guide.png" style="width:30px" alt="Guide">
            <h4>Guide</h4>
        </button>
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closePopup()">&times;</span>
                <p>Test
                </p>
            </div>
        </div>
    </header>
    <script>
        function showGuide() {
            var modal = document.getElementById("myModal");
            modal.style.display = "block";
            document.addEventListener("keydown", closeOnEscape);
        }

        function closePopup() {
            var modal = document.getElementById("myModal");
            modal.style.display = "none";
            document.removeEventListener("keydown", closeOnEscape);
        }

        function closeOnEscape(event) {
            if (event.key === "Escape") {
                closePopup();
            }
        }
    </script>
    <div class="content">
        <div class="containerIntegration">
            <div class="headerIntegration">
                <h4 id="integration-method"><b>Numerische Integration: Trapezregel</b></h4>
                <button class="fa fa-info-circle" onclick="showGuide()"
                    style="font-size:24px; margin-left: 10px; color:grey; border:0; background-color: transparent;"></button>
            </div>
            <div class="radio-buttons">
                <input class="form-check-input" type="radio" id="trapez" name="integration-method" value="Trapezregel"
                    onchange="updateHeader(this)" checked>
                <label for="trapez">Trapezregel</label><br>
                <input class="form-check-input" type="radio" id="simpson" name="integration-method" value="Simpsonregel"
                    onchange="updateHeader(this)">
                <label for="simpson">Simpsonregel</label><br>
            </div>
        </div><br>

        <script>
            function updateHeader(radio) {
                if (radio.checked) {
                    document.getElementById('integration-method').innerHTML = `<b>Numerische Integration: ${radio.value}</b>`;
                    ggbApplet.reset()
                    if (checkInputs()) {
                        zeichneFunktion()
                    } else {
                        var button = document.getElementById('integralButton');
                        button.style.display = "none"
                        const nachkommastellen = document.getElementById('nachkomastellenContainer').style.display = "none";
                        document.getElementById('btnZeichne').disabled = true;
                        var checkbox = document.getElementById('myCheckbox')
                        checkbox.checked = false;
                        checkbox.style.display ="none"
                        document.getElementById('checkboxLabel').style.display="none"
                        document.getElementById('stammfunktionContainer').style.display = "none";
                    }
                    const resultContainer = document.getElementById('resultContainer').innerHTML = "";
                    const histogramm = document.getElementById('abweichungsHistogramm').innerHTML = "";
                    if (radio.value == "Simpsonregel") {
                        document.getElementById('sliderValue').innerText = "Anzahl Parabeln: " + document.getElementById('punktPosition').value;

                    } else {
                        document.getElementById('sliderValue').innerText = "Anzahl Trapeze: " + document.getElementById('punktPosition').value;

                    }

                }
            }
        </script>
        <div style="display: flex; justify-content: space-around; align-items: center;">
            <div style="flex: 1; text-align: center;">
                <table style="margin: auto;" class="table table-hover">
                    <tbody>
                        <tr>
                            <td><label for="funktion">Funktion f(x)</label></td>
                            <td><input type="text" id="funktion"></td>
                        </tr>
                        <tr>
                            <td><label for="untereGrenze">Untere Grenze (a)</label></td>
                            <td><input type="number" id="untereGrenze"></td>
                        </tr>
                        <tr>
                            <td><label for="obereGrenze">Obere Grenze (b)</label></td>
                            <td><input type="number" id="obereGrenze"></td>
                        </tr>
                    </tbody>
                </table>
                <br>
                <button id="btnZeichne" onclick="zeichneFunktion()" disabled class="btn btn-secondary">Zeichne Funktion
                    ein</button> <br><br>
                <div class="controls">
                    <div style="margin:auto; display:flex">
                        <button id="skip-back" onclick="stepwiseChange(-1)" disabled>
                            <i class="fas fa-backward"></i>
                        </button>
                        <button id="play-pause" style="margin-inline: 20px;" disabled>
                            <i class="fas fa-play" id="play-icon"></i>
                            <i class="fas fa-pause" id="pause-icon" style="display: none;"></i>
                        </button>
                        <button id="skip-forward" onclick="stepwiseChange(1)" disabled>
                            <i class="fas fa-forward"></i>
                        </button>
                    </div>
                </div>
                <br>
                <input style="display:none" type="checkbox" style="margin-top: 10px;" id="myCheckbox"
                    class="form-check-input"> <label style="display:none" id="checkboxLabel" for="myCheckbox">Mit
                    Stammfunktion vergleichen</label><br><br>
                <table class="table table-hover" id="stammfunktionContainer" style="display:none">
                    <tr>
                        <td><label for="stammfunktion">Stammfunktion
                                F(x)</label></td>
                        <td> <input type="text" id="stammfunktion" id="inputField" data-toggle="popover"
                                data-placement="bottom" data-content="UngÃ¼ltige Stammfunktion!"></td>
                    </tr>
                </table>
            </div>
            <div>
                <div id="ggb-element" style="flex: 1; text-align: center; margin: auto;"></div>
                <div class="slider-container"
                    style="width: 600px; display: flex; flex-direction: column; align-items: center;">
                    <br>
                    <span id="sliderValue">Anzahl Trapeze: 5</span>
                    <input type="range" id="punktPosition" min="1" style="width: 100%;" max="50" value="5" step="1"
                        oninput="bewegePunkt(this.value)" onchange="zeichneFunktion()"><br>
                </div>
            </div>
            <div style="flex: 1; text-align: center; margin-left:30px">
                <button id="integralButton" class="btn btn-secondary" onclick="berechneIntegral()">Berechne
                    Integral</button><br><br>
                <table id="nachkomastellenContainer" style="display:none;" class="table table-hover">
                    <tr>
                        <td>Anzahl Nachkommastellen</td>
                        <td>
                            <select id="nachkomastellen" class="form-select">
                                <option>1</option>
                                <option selected>2</option>
                                <option>3</option>
                                <option>4</option>
                                <option>5</option>
                                <option>6</option>
                                <option>7</option>
                                <option>8</option>
                                <option>9</option>
                                <option>10</option>
                            </select>
                        </td>
                    </tr>
                </table>
                <div id="resultContainer"></div><br>
                <canvas id="abweichungsHistogramm"></canvas><br>
            </div>
        </div>
        <div id="diagramm" style="width:1400px;height:400px;display:none"></div>
        <script src="./script.js"></script>
    </div>
</body>

</html>